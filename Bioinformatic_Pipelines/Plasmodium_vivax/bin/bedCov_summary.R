


args <- commandArgs(trailingOnly = T)
sample <- args[1]
inFile <- read.table(args[2], sep="\t", header = F)

# chroms <- c(
# "AL844501.2",
# "LN999944.1",
# "LN999945.1",
# "LN999947.1",
# "AL844509.3",
# "LN999946.1",
# "LN999943.1",
# "AL844502.2",
# "AL844503.2",
# "AL844504.2",
# "AL844505.2",
# "AL844506.3",
# "AL844507.3",
# "AL844508.2"
# )

chroms <- c("LT635626.1","LT635627.1","LT635612.2","LT635613.2","LT635614.2","LT635615.1","LT635616.2","LT635617.2","LT635618.2","LT635619.1","LT635620.2","LT635621.2","LT635622.1","LT635623.1","LT635624.2","LT635625.2","FLZR02000001.1","FLZR02000002.1","FLZR02000003.1","FLZR02000004.1","FLZR02000005.1","FLZR02000006.1","FLZR02000007.1","FLZR02000008.1","FLZR02000009.1","FLZR02000010.1","FLZR02000011.1","FLZR02000012.1","FLZR02000013.1","FLZR02000014.1","FLZR02000015.1","FLZR02000016.1","FLZR02000017.1","FLZR02000018.1","FLZR02000019.1","FLZR02000020.1","FLZR02000021.1","FLZR02000022.1","FLZR02000023.1","FLZR02000024.1","FLZR02000025.1","FLZR02000026.1","FLZR02000027.1","FLZR02000028.1","FLZR02000029.1","FLZR02000030.1","FLZR02000031.1","FLZR02000032.1","FLZR02000033.1","FLZR02000034.1","FLZR02000035.1","FLZR02000036.1","FLZR02000037.1","FLZR02000038.1","FLZR02000039.1","FLZR02000040.1","FLZR02000041.1","FLZR02000042.1","FLZR02000043.1","FLZR02000044.1","FLZR02000045.1","FLZR02000046.1","FLZR02000047.1","FLZR02000048.1","FLZR02000049.1","FLZR02000050.1","FLZR02000051.1","FLZR02000052.1","FLZR02000053.1","FLZR02000054.1","FLZR02000055.1","FLZR02000056.1","FLZR02000057.1","FLZR02000058.1","FLZR02000059.1","FLZR02000060.1","FLZR02000061.1","FLZR02000062.1","FLZR02000063.1","FLZR02000064.1","FLZR02000065.1","FLZR02000066.1","FLZR02000067.1","FLZR02000068.1","FLZR02000069.1","FLZR02000070.1","FLZR02000071.1","FLZR02000072.1","FLZR02000073.1","FLZR02000074.1","FLZR02000075.1","FLZR02000076.1","FLZR02000077.1","FLZR02000078.1","FLZR02000079.1","FLZR02000080.1","FLZR02000081.1","FLZR02000082.1","FLZR02000083.1","FLZR02000084.1","FLZR02000085.1","FLZR02000086.1","FLZR02000087.1","FLZR02000088.1","FLZR02000089.1","FLZR02000090.1","FLZR02000091.1","FLZR02000092.1","FLZR02000093.1","FLZR02000094.1","FLZR02000095.1","FLZR02000096.1","FLZR02000097.1","FLZR02000098.1","FLZR02000099.1","FLZR02000100.1","FLZR02000101.1","FLZR02000102.1","FLZR02000103.1","FLZR02000104.1","FLZR02000105.1","FLZR02000106.1","FLZR02000107.1","FLZR02000108.1","FLZR02000109.1","FLZR02000110.1","FLZR02000111.1","FLZR02000112.1","FLZR02000113.1","FLZR02000114.1","FLZR02000115.1","FLZR02000116.1","FLZR02000117.1","FLZR02000118.1","FLZR02000119.1","FLZR02000120.1","FLZR02000121.1","FLZR02000122.1","FLZR02000123.1","FLZR02000124.1","FLZR02000125.1","FLZR02000126.1","FLZR02000127.1","FLZR02000128.1","FLZR02000129.1","FLZR02000130.1","FLZR02000131.1","FLZR02000132.1","FLZR02000133.1","FLZR02000134.1","FLZR02000135.1","FLZR02000136.1","FLZR02000137.1","FLZR02000138.1","FLZR02000139.1","FLZR02000140.1","FLZR02000141.1","FLZR02000142.1","FLZR02000143.1","FLZR02000144.1","FLZR02000145.1","FLZR02000146.1","FLZR02000147.1","FLZR02000148.1","FLZR02000149.1","FLZR02000150.1","FLZR02000151.1","FLZR02000152.1","FLZR02000153.1","FLZR02000154.1","FLZR02000155.1","FLZR02000156.1","FLZR02000157.1","FLZR02000158.1","FLZR02000159.1","FLZR02000160.1","FLZR02000161.1","FLZR02000162.1","FLZR02000163.1","FLZR02000164.1","FLZR02000165.1","FLZR02000166.1","FLZR02000167.1","FLZR02000168.1","FLZR02000169.1","FLZR02000170.1","FLZR02000171.1","FLZR02000172.1","FLZR02000173.1","FLZR02000174.1","FLZR02000175.1","FLZR02000176.1","FLZR02000177.1","FLZR02000178.1","FLZR02000179.1","FLZR02000180.1","FLZR02000181.1","FLZR02000182.1","FLZR02000183.1","FLZR02000184.1","FLZR02000185.1","FLZR02000186.1","FLZR02000187.1","FLZR02000188.1","FLZR02000189.1","FLZR02000190.1","FLZR02000191.1","FLZR02000192.1","FLZR02000193.1","FLZR02000194.1","FLZR02000195.1","FLZR02000196.1","FLZR02000197.1","FLZR02000198.1","FLZR02000199.1","FLZR02000200.1","FLZR02000201.1","FLZR02000202.1","FLZR02000203.1","FLZR02000204.1","FLZR02000205.1","FLZR02000206.1","FLZR02000207.1","FLZR02000208.1","FLZR02000209.1","FLZR02000210.1","FLZR02000211.1","FLZR02000212.1","FLZR02000213.1","FLZR02000214.1","FLZR02000215.1","FLZR02000216.1","FLZR02000217.1","FLZR02000218.1","FLZR02000219.1","FLZR02000220.1","FLZR02000221.1","FLZR02000222.1","FLZR02000223.1","FLZR02000224.1","FLZR02000225.1","FLZR02000226.1")

perChromSize <- c("29582","5989","1021664","956327","896704","1012024","1524814","1042791","1652210","1761288","2237066","1548844","2131221","3182763","2093556","3153402","402823","329406","213262","167607","153551","148258","138489","136931","132466","132426","123358","118908","111388","101449","98688","98334","94527","91632","86105","72856","71907","61457","64741","64543","59933","58047","56610","47197","45364","43143","41255","40940","39305","39018","36874","34802","34237","33748","30627","27412","27035","26582","26325","25707","24787","24222","21501","21425","21386","20857","20797","20223","19059","17847","10812","16781","16268","14706","14647","14186","5760","12076","11608","10956","10707","10408","10338","10042","9728","8944","8855","8141","8043","7954","7518","7482","7384","6875","6603","6500","6456","1874","5910","5840","5572","5003","4744","4551","4453","4365","4312","4222","4184","4144","4062","3927","3914","3825","3796","3768","3767","3707","3685","3501","3319","3094","2818","2649","2551","2537","2521","2382","2370","2164","2157","2093","2029","1921","1902","1882","1873","1856","1846","1827","1822","1818","1793","1780","1769","1738","1720","1657","1648","1634","1626","1615","1613","1586","1539","1520","1522","1518","1517","1515","1506","1499","1482","1499","1469","1459","1442","1425","1433","1410","1405","1391","1382","1381","1375","1359","1357","1373","1353","1352","1346","1335","1320","1308","1306","1295","1291","1289","1287","1274","1272","1263","1257","1243","1241","1249","1212","1210","1203","1200","1200","1191","1191","1191","1173","1162","1142","1139","1139","1139","1136","1132","1130","1109","1124","1113","1107","1100","1092","1089","1084","1073","1072","1070","1070","1063","1061","1060","1056","1055","1055","1053","1067","1039","1037","1020","1019","1015","1011","1007","43799","1608")
# perChromSize <- c(640851,
# 947102,
# 1067971,
# 1200490,
# 1343557,
# 1418242,
# 1445207,
# 1472805,
# 1541735,
# 1687656,
# 2038340,
# 2271494,
# 2925236,
# 3291936)


total5 <- inFile[inFile[,2] >=5,3]
total20 <- inFile[inFile[,2] >=20,3]
total50 <- inFile[inFile[,2] >=50,3]
total100 <- inFile[inFile[,2] >=100,3]
total500 <- inFile[inFile[,2] >=500,3]
total1000 <- inFile[inFile[,2] >=1000,3]

outFile <- as.data.frame(matrix(ncol = 8, nrow = 14))
for(i in 1:242){
    # search <- chroms[i]
    chromLength <- perChromSize[i]
    chromFile <- inFile[grep(chroms[i], inFile[,1]),]
    totalLength <- chromFile[1,4]
    x5 <- chromFile[chromFile[,2] >=5,3]
    x20 <- chromFile[chromFile[,2] >=20,3]
    x50 <- chromFile[chromFile[,2] >=50,3]
    x100 <- chromFile[chromFile[,2] >=100,3]
    x500 <- chromFile[chromFile[,2] >=500,3]
    x1000 <- chromFile[chromFile[,2] >=1000,3]
    # print(sum(x5)/totalLength *100)
    # print(sum(x1000)/totalLength *100)
    outFile[i,1] <- chroms[i]
    outFile[i,2] <- sum(x5)/totalLength *100
    outFile[i,3] <- sum(x20)/totalLength *100
    outFile[i,4] <- sum(x50)/totalLength *100
    outFile[i,5] <- sum(x100)/totalLength *100
    outFile[i,6] <- sum(x500)/totalLength *100
    outFile[i,7] <- sum(x1000)/totalLength *100
}

# fullSize <- 23292622
# outFile[15,1] <- "FullGenome"
# outFile[15,2] <- sum(total5)/fullSize *100
# outFile[15,3] <- sum(total20)/fullSize *100
# outFile[15,4] <- sum(total50)/fullSize *100
# outFile[15,5] <- sum(total100)/fullSize *100
# outFile[15,6] <- sum(total500)/fullSize *100
# outFile[15,7] <- sum(total1000)/fullSize *100
outFile[,8] <- sample

colnames(outFile) <- c("Chromosome", "Percent_5xCoverage","Percent_20xCoverage","Percent_50xCoverage","Percent_100xCoverage","Percent_500xCoverage","Percent_1000xCoverage")

# perChromSize <- c(640851,
# 947102,
# 1067971,
# 1200490,
# 1343557,
# 1418242,
# 1445207,
# 1472805,
# 1541735,
# 1687656,
# 2038340,
# 2271494,
# 2925236,
# 3291936)





write.csv(outFile, file = paste(sample, "_pvp01_perChrom_coverage.csv", sep = ""), row.names= F, quote =F)